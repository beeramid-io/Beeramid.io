<h3><span id="ownedBy"></span>'s room</h3>

Waiting for players...
<br/>

<form action="leaveRoom">
  <input type="submit" value="Leave"/>
</form>

<div id="users"></div>

<button id="runGameButton">Run Game</button>

<script>
  document.getElementById('ownedBy').innerHTML = data.ownedBy;
</script>

<script>
  // SOCKET

  var s = new WebSocket('ws://' + window.location.host + '/');

  s.addEventListener('error', function (m) { console.log('websocket connection error'); });

  s.addEventListener('open', function (m) {
    console.log('websocket connection opened');
    s.send(JSON.stringify({ 'message': 'amIOwner' }));
  });

  s.addEventListener('message', function (message) {
    var data = JSON.parse(message.data);
    
    if (typeof data['users'] !== 'undefined') {
      var usersHtml = '<h4>Players:</h4><ul>';
      data['users'].forEach(function(user) {
        usersHtml += '<li>' + user['nickname'] + '</li>';
      });
      usersHtml += '</ul>'
      document.getElementById('users').innerHTML = usersHtml;
    }
    
    if (typeof data['iAmOwner'] !== 'undefined') {
      document.getElementById('runGameButton').disabled = !data['iAmOwner'];
    }
    
    if (typeof data['message'] !== 'undefined') {
      switch (data['message']) {
        case 'refresh':
          document.location.reload(true);
          break;
        default: 
      };
    }
  });

  document.getElementById('runGameButton').onclick = function() {
    s.send(JSON.stringify({ 'message': 'runGame' }));
  };

</script>